<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuma≈ü Stok Y√∂netimi</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="print.css" media="print">
</head>
<body>
    <div id="app">
        <!-- Loading State -->
        <div id="loading" class="loading-overlay">
            <div class="spinner"></div>
            <p>Y√ºkleniyor...</p>
        </div>

        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-brand">
                <h1>Kuma≈ü Stok Y√∂netimi</h1>
            </div>
            <div class="nav-menu">
                <a href="#dashboard" class="nav-link active" data-page="dashboard">Ana Sayfa</a>
                <a href="#customers" class="nav-link" data-page="customers">M√º≈üteriler</a>
                <a href="#inventory" class="nav-link" data-page="inventory">Stok</a>
                <a href="#shipments" class="nav-link" data-page="shipments">Sevkler</a>
                <a href="#suppliers" class="nav-link" data-page="suppliers">√ñdemeler</a>
                <a href="#reports" class="nav-link" data-page="reports">Raporlar</a>
                <a href="#settings" class="nav-link" data-page="settings">Ayarlar</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="dashboard-header">
                    <h1 class="dashboard-title">ƒ∞≈ületme Y√∂netim Paneli</h1>
                    <div class="dashboard-period">Son 30 G√ºn</div>
                    <div class="dashboard-actions">
                        <button class="btn btn-primary" onclick="showNewShipmentModal()">
                            <span class="icon">+</span>
                            Yeni Sevk
                        </button>
                    </div>
                </div>

                <div class="dashboard-cards">
                    <!-- Net Kar -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Net Kar</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric">
                                <span class="value" id="net-profit">$0</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Satƒ±≈ülar:</span>
                                <span class="value positive" id="total-sales">$0</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Maliyetler:</span>
                                <span class="value negative" id="total-costs">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Satƒ±≈ülar -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Satƒ±≈ülar (30 G√ºn)</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric">
                                <span class="value" id="last30-shipment-usd">$0</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Toplam Kg:</span>
                                <span class="value" id="last30-shipment-kg">0 kg</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Ort. Fiyat:</span>
                                <span class="value" id="monthly-avg-price">$0/kg</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stok -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Stok Durumu</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric">
                                <span class="value" id="total-stock-kg">0</span>
                                <span class="unit">kg</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Stokta:</span>
                                <span class="value" id="stock-available">0 kg</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Kƒ±smi:</span>
                                <span class="value" id="stock-partial">0 kg</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Biten:</span>
                                <span class="value" id="stock-finished">0 adet</span>
                            </div>
                        </div>
                    </div>

                    <!-- Alacaklar -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Alacaklar</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric">
                                <span class="value" id="open-receivables">$0</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">M√º≈üteri Sayƒ±sƒ±:</span>
                                <span class="value" id="receivables-count">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="recent-activities">
                    <div class="card">
                        <div class="card-header">
                            <h3>Son Hareketler</h3>
                        </div>
                        <div class="card-content">
                            <div id="recent-activities-list" class="activities-list">
                                <!-- Recent activities will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customers Page -->
            <div id="customers-page" class="page">
                <div class="page-header">
                    <h2>M√º≈üteriler</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" onclick="showNewCustomerModal()">
                            <span class="icon">+</span>
                            Yeni M√º≈üteri
                        </button>
                    </div>
                </div>
                
                <div class="search-filter-bar">
                    <input type="text" id="customer-search" placeholder="M√º≈üteri ara..." class="search-input">
                </div>
                
                <div class="table-container">
                    <table id="customers-table" class="data-table">
                        <thead>
                            <tr>
                                <th data-sort="name">M√º≈üteri Adƒ±</th>
                                <th data-sort="phone">Telefon</th>
                                <th data-sort="email">E-posta</th>
                                <th data-sort="balance">Bakiye (USD)</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="customers-table-body">
                            <!-- Customer rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Customer Detail Page -->
            <div id="customer-detail-page" class="page">
                <div class="page-header">
                    <button class="btn btn-secondary back-btn" onclick="showPage('customers')">
                        ‚Üê Geri
                    </button>
                    <h2 id="customer-detail-name">M√º≈üteri Detayƒ±</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" onclick="showNewShipmentModal()">
                            <span class="icon">+</span>
                            Yeni Sevk
                        </button>
                        <button class="btn btn-secondary" onclick="showNewPaymentModal()">
                            <span class="icon">$</span>
                            Tahsilat Ekle
                        </button>
                        <button class="btn btn-outline" onclick="printCustomerStatement()">
                            <span class="icon">üìÑ</span>
                            PDF Ekstre
                        </button>
                    </div>
                </div>

                <div class="customer-summary-cards">
                    <div class="card">
                        <div class="card-header">
                            <h3>Toplam Bakiye</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric">
                                <span class="value" id="customer-total-balance">$0</span>
                                <span class="unit">USD</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Son 30 G√ºn</h3>
                        </div>
                        <div class="card-content">
                            <div class="metric-row">
                                <span class="label">Sevk:</span>
                                <span id="customer-30d-kg">0 kg</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Toplam:</span>
                                <span id="customer-30d-usd">$0 USD</span>
                            </div>
                            <div class="metric-row">
                                <span class="label">Ort. Fiyat:</span>
                                <span id="customer-30d-avg">$0/kg</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="customer-tabs">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="shipments">Sevkler</button>
                        <button class="tab-btn" data-tab="payments">Tahsilatlar</button>
                        <button class="tab-btn" data-tab="statement">Ekstre</button>
                    </div>

                    <div class="tab-content">
                        <div id="shipments-tab" class="tab-pane active">
                            <div class="tab-filters">
                                <select id="shipments-period-filter">
                                    <option value="7">Son 7 G√ºn</option>
                                    <option value="30" selected>Son 30 G√ºn</option>
                                    <option value="90">Son 90 G√ºn</option>
                                    <option value="all">T√ºm√º</option>
                                    <option value="custom">√ñzel Tarih</option>
                                </select>
                                <div id="custom-date-range" class="date-range hidden">
                                    <input type="date" id="shipments-start-date">
                                    <input type="date" id="shipments-end-date">
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Tarih</th>
                                            <th>√úr√ºn</th>
                                            <th>Parti</th>
                                            <th>Kg</th>
                                            <th>Birim (USD)</th>
                                            <th>Toplam (USD)</th>
                                            <th>ƒ∞≈ülemler</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-shipments-table">
                                        <!-- Shipment rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div id="payments-tab" class="tab-pane">
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Tarih</th>
                                            <th>Tutar (USD)</th>
                                            <th>Y√∂ntem</th>
                                            <th>Not</th>
                                            <th>ƒ∞≈ülemler</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-payments-table">
                                        <!-- Payment rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div id="statement-tab" class="tab-pane">
                            <div class="tab-filters">
                                <select id="statement-period-filter">
                                    <option value="30">Son 30 G√ºn</option>
                                    <option value="90">Son 90 G√ºn</option>
                                    <option value="all">T√ºm√º</option>
                                    <option value="custom">√ñzel Tarih</option>
                                </select>
                                <div id="statement-custom-date-range" class="date-range hidden">
                                    <input type="date" id="statement-start-date">
                                    <input type="date" id="statement-end-date">
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Tarih</th>
                                            <th>A√ßƒ±klama</th>
                                            <th>Bor√ß (USD)</th>
                                            <th>Alacak (USD)</th>
                                            <th>Bakiye (USD)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-statement-table">
                                        <!-- Statement rows will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Page -->
            <div id="inventory-page" class="page">
                <div class="page-header">
                    <h2>Stok (Partiler)</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" onclick="showNewLotModal()">
                            <span class="icon">+</span>
                            Yeni Parti
                        </button>
                        <button class="btn btn-secondary" onclick="exportInventoryCSV()">CSV Dƒ±≈üa Aktar</button>
                        <button class="btn btn-secondary" onclick="showImportCSVModal()">CSV ƒ∞√ße Aktar</button>
                    </div>
                </div>
                
                <div class="search-filter-bar">
                    <input type="text" id="inventory-search" placeholder="Parti ara..." class="search-input">
                    <select id="inventory-product-filter" class="filter-select">
                        <option value="">T√ºm √úr√ºnler</option>
                    </select>
                    <select id="inventory-status-filter" class="filter-select">
                        <option value="">T√ºm Durumlar</option>
                        <option value="Stokta">Stokta</option>
                        <option value="Kƒ±smi">Kƒ±smi</option>
                        <option value="Bitti">Bitti</option>
                    </select>
                </div>
                
                <div class="table-container">
                    <table id="inventory-table" class="data-table">
                        <thead>
                            <tr>
                                <th data-sort="productName">Kuma≈ü</th>
                                <th data-sort="party">Parti</th>
                                <th data-sort="color">Renk</th>
                                <th data-sort="location">Konum</th>
                                <th data-sort="remainingKg">Kalan (kg)</th>
                                <th data-sort="status">Durum</th>
                                <th data-sort="date">Tarih</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-table-body">
                            <!-- Inventory rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Shipments Page -->
            <div id="shipments-page" class="page">
                <div class="page-header">
                    <h2>Sevkler</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" onclick="showNewShipmentModal()">
                            <span class="icon">+</span>
                            Yeni Sevk
                        </button>
                    </div>
                </div>
                
                <div class="search-filter-bar">
                    <input type="text" id="shipments-search" placeholder="Sevk ara..." class="search-input">
                    <select id="shipments-customer-filter" class="filter-select">
                        <option value="">T√ºm M√º≈üteriler</option>
                    </select>
                    <select id="shipments-period-filter" class="filter-select">
                        <option value="7">Son 7 G√ºn</option>
                        <option value="30">Son 30 G√ºn</option>
                        <option value="90">Son 90 G√ºn</option>
                        <option value="all">T√ºm Zamanlar</option>
                    </select>
                </div>
                
                <div class="table-container">
                    <table id="shipments-table" class="data-table">
                        <thead>
                            <tr>
                                <th data-sort="id">Sevk No</th>
                                <th data-sort="date">Tarih</th>
                                <th data-sort="customerName">M√º≈üteri</th>
                                <th data-sort="totalKg">Toplam Kg</th>
                                <th data-sort="totalUsd">Toplam USD</th>
                                <th data-sort="note">Not</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="shipments-table-body">
                            <!-- Shipment rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Suppliers/Payments Page -->
            <div id="suppliers-page" class="page">
                <div class="page-header">
                    <h2>Tedarik√ßi √ñdemeleri</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" onclick="showNewSupplierModal()">
                            <span class="icon">+</span>
                            Yeni Tedarik√ßi
                        </button>
                        <button class="btn btn-secondary" onclick="showNewSupplierPaymentModal()">
                            <span class="icon">$</span>
                            √ñdeme Yap
                        </button>
                    </div>
                </div>

                <div class="search-filter-bar">
                    <select id="costs-product-filter" class="filter-select">
                        <option value="">T√ºm √úr√ºnler</option>
                    </select>
                    <select id="costs-status-filter" class="filter-select">
                        <option value="">T√ºm Durumlar</option>
                        <option value="pending">√ñdeme Bekliyor</option>
                        <option value="partial">Kƒ±smi √ñdendi</option>
                        <option value="paid">√ñdendi</option>
                    </select>
                </div>

                <!-- √ñdeme √ñzeti -->
                <div class="payment-summary-section">
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="summary-card-header">
                                <h4>ƒ∞plik Tedarik√ßisi</h4>
                                <span class="summary-icon">üßµ</span>
                            </div>
                            <div class="summary-card-content">
                                <div class="summary-amount">
                                    <span class="amount-label">√ñdenecek:</span>
                                    <span class="amount-value" id="yarn-outstanding">$0</span>
                                </div>
                                <div class="summary-amount">
                                    <span class="amount-label">Toplam Bor√ß:</span>
                                    <span class="amount-value" id="yarn-total">$0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="summary-card">
                            <div class="summary-card-header">
                                <h4>√ñrme Tedarik√ßisi</h4>
                                <span class="summary-icon">üß∂</span>
                            </div>
                            <div class="summary-card-content">
                                <div class="summary-amount">
                                    <span class="amount-label">√ñdenecek:</span>
                                    <span class="amount-value" id="knitting-outstanding">$0</span>
                                </div>
                                <div class="summary-amount">
                                    <span class="amount-label">Toplam Bor√ß:</span>
                                    <span class="amount-value" id="knitting-total">$0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="summary-card">
                            <div class="summary-card-header">
                                <h4>Boyahane</h4>
                                <span class="summary-icon">üé®</span>
                            </div>
                            <div class="summary-card-content">
                                <div class="summary-amount">
                                    <span class="amount-label">√ñdenecek:</span>
                                    <span class="amount-value" id="dyeing-outstanding">$0</span>
                                </div>
                                <div class="summary-amount">
                                    <span class="amount-label">Toplam Bor√ß:</span>
                                    <span class="amount-value" id="dyeing-total">$0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="summary-card total-card">
                            <div class="summary-card-header">
                                <h4>Genel Toplam</h4>
                                <span class="summary-icon">üí∞</span>
                            </div>
                            <div class="summary-card-content">
                                <div class="summary-amount">
                                    <span class="amount-label">Toplam √ñdenecek:</span>
                                    <span class="amount-value total-outstanding" id="total-outstanding">$0</span>
                                </div>
                                <div class="summary-amount">
                                    <span class="amount-label">Toplam Bor√ß:</span>
                                    <span class="amount-value total-debt" id="total-debt">$0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Parti</th>
                                <th>√úr√ºn</th>
                                <th>Toplam KG</th>
                                <th>ƒ∞plik (USD/KG)</th>
                                <th>ƒ∞plik Toplam</th>
                                <th>√ñrme (USD/KG)</th>
                                <th>√ñrme Toplam</th>
                                <th>Boyahane (USD/KG)</th>
                                <th>Boyahane Toplam</th>
                                <th>Toplam Maliyet</th>
                                <th>√ñdenen</th>
                                <th>Kalan</th>
                                <th>Durum</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="production-costs-table">
                            <!-- Production costs will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reports-page" class="page">
                <div class="page-header">
                    <h2>Raporlar</h2>
                </div>
                
                <div class="reports-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>M√º≈üteri Bazlƒ± Sevk Raporu</h3>
                        </div>
                        <div class="card-content">
                            <p>Son 30 g√ºnde m√º≈üterilere g√∂re sevk toplamlarƒ±</p>
                            <button class="btn btn-primary" onclick="generateCustomerShipmentReport()">
                                <span class="icon">üìä</span>
                                Rapor Olu≈ütur
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>√úr√ºn Bazlƒ± Sevk Raporu</h3>
                        </div>
                        <div class="card-content">
                            <p>√úr√ºnlere g√∂re sevk analizi</p>
                            <button class="btn btn-primary" onclick="generateProductShipmentReport()">
                                <span class="icon">üìä</span>
                                Rapor Olu≈ütur
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Tahsilat Raporu</h3>
                        </div>
                        <div class="card-content">
                            <p>Tahsilat hareketleri ve y√∂ntemleri</p>
                            <button class="btn btn-primary" onclick="generatePaymentReport()">
                                <span class="icon">üìä</span>
                                Rapor Olu≈ütur
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="report-results" class="report-results hidden">
                    <div class="card">
                        <div class="card-header">
                            <h3 id="report-title">Rapor Sonu√ßlarƒ±</h3>
                            <button class="btn btn-secondary" onclick="exportReportCSV()">
                                <span class="icon">üì•</span>
                                CSV Dƒ±≈üa Aktar
                            </button>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table id="report-table" class="data-table">
                                    <thead id="report-table-head">
                                        <!-- Report headers will be populated here -->
                                    </thead>
                                    <tbody id="report-table-body">
                                        <!-- Report data will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settings-page" class="page">
                <div class="page-header">
                    <h2>Ayarlar</h2>
                </div>
                
                <div class="settings-sections">
                    <div class="card">
                        <div class="card-header">
                            <h3>Firma Bilgileri</h3>
                        </div>
                        <div class="card-content">
                            <form id="company-settings-form">
                                <div class="form-group">
                                    <label for="company-name">Firma Adƒ±</label>
                                    <input type="text" id="company-name" name="companyName" placeholder="Firma adƒ±nƒ±zƒ± girin">
                                </div>
                                <div class="form-group">
                                    <label for="company-address">Adres</label>
                                    <textarea id="company-address" name="companyAddress" placeholder="Firma adresinizi girin"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="company-phone">Telefon</label>
                                    <input type="text" id="company-phone" name="companyPhone" placeholder="Telefon numaranƒ±zƒ± girin">
                                </div>
                                                        <div class="form-group">
                            <label for="company-logo-text">Logo Metni</label>
                            <input type="text" id="company-logo-text" name="companyLogoText" placeholder="PDF'lerde g√∂r√ºnecek logo metni">
                        </div>
                        <div class="form-group">
                            <label for="company-logo">Logo Resmi</label>
                            <input type="file" id="company-logo" name="companyLogo" accept="image/*" onchange="handleLogoUpload(this)">
                            <small class="text-muted">PNG, JPG veya SVG formatƒ±nda logo y√ºkleyebilirsiniz</small>
                            <div id="logo-preview" class="logo-preview hidden">
                                <img id="logo-preview-img" alt="Logo √∂nizleme" style="max-width: 200px; max-height: 100px; border: 1px solid #ddd; border-radius: 4px; margin-top: 10px;">
                                <button type="button" class="btn btn-sm btn-danger" onclick="removeLogo()" style="margin-left: 10px;">Logoyu Kaldƒ±r</button>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <span class="icon">üíæ</span>
                            Kaydet
                        </button>
                            </form>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3>Veri Y√∂netimi</h3>
                        </div>
                        <div class="card-content">
                            <div class="data-management-actions">
                                <button class="btn btn-secondary" onclick="loadTestData()">
                                    <span class="icon">üß™</span>
                                    Test Verisi Y√ºkle
                                </button>
                                <button class="btn btn-secondary" onclick="exportData()">
                                    <span class="icon">üì§</span>
                                    Veri Dƒ±≈üa Aktar (JSON)
                                </button>
                                <button class="btn btn-secondary" onclick="showImportDataModal()">
                                    <span class="icon">üì•</span>
                                    Veri ƒ∞√ße Aktar (JSON)
                                </button>
                                <button class="btn btn-danger" onclick="clearAllData()">
                                    <span class="icon">üóëÔ∏è</span>
                                    T√ºm Veriyi Temizle
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container">
            <!-- Toast messages will be added here -->
        </div>
    </div>

    <!-- Modals will be added here by JavaScript -->
    <div id="modal-container"></div>

    <script src="js/utils.js"></script>
    <script src="js/database.js"></script>
    <script src="js/services.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/pages.js"></script>
    <script src="js/app.js"></script>
</body>
</html>